{% if site.tags.size > 0 %}
	{% assign javascript_tag_html = null %}
	{% capture javascript_tag_html %}
		<script type="text/javascript">
			var posts = [
				{% for javascript_post in site.posts %}
					{% if forloop.first %}
						{
					{% else %}
						, {
					{% endif %}
							"title" : "{{ javascript_post.title | replace: '"', '\"' }}" , 
							"subtitle" : "{{ javascript_post.subtitle | replace: '"', '\"' }}" , 
							"description" : "{{ javascript_post.description | replace: '"', '\"' }}" , 
							"url" : "{{site.url}}{{ javascript_post.url | replace: '"', '\"' }}" , 
							"date" : "{{ javascript_post.date | replace: '"', '\"' }}" , 
							"category" : "{{ javascript_post.category | replace: ' ', '___' | replace: '"', '\"' | downcase }}" , 
							"tags" : 
								[
									{% for javascript_post_tag in javascript_post.tags %}
										{% if forloop.first %}
											"{{ javascript_post_tag | replace: ' ', '___' | replace: '"', '\"' | downcase }}"
										{% else %}
											, "{{ javascript_post_tag | replace: ' ', '___' | replace: '"', '\"' | downcase }}"
										{% endif %}
									{% endfor %}
								]
						}
				{% endfor %}
			];

			var requested_tag = null;
			var url_params = $(location).attr('href').match(/\?tag=.+/);
			if (url_params !== null) {
				requested_tag = url_params[0].split('&')[0].split('?tag=')[1];
			};

			if (requested_tag === null) {
				$('div[name="tag_body"]').append('<p>No tag supplied.</p>');
			} else {
				for (var i = 0; i < posts.length; i++) {
					$('div[name="tag_body"]').append('<p>' + posts[i].title + '</p>');
				};
			};
		</script>
	{% endcapture %}
	{{ javascript_tag_html | strip_newlines | remove:'	' }}
{% endif %}